### GEO indices to ARRAY INDICES

INPUT = 'POLYGON((14.853515624999996 63.391521744008855,14.853515624999996 62.694309593663206,16.962890625 62.694309593663206,16.083984374999996 63.54855223203643,14.853515624999996 63.391521744008855))

	upper_left_lon_x = GetExtent(rds)['Upper_Left'][0] # should be fetched from xr.dataset or gdal dataset rds
	upper_left_lat_y = GetExtent(rds)['Upper_Left'][1] # should be fetched from xr.dataset
	pixel_size = GetExtent(rds)['xpixel'] # should be fetched from xr.dataset

	longs,lats = geoPOLYGON_to_gridPOLYGON('POLYGON((14.853515624999996 63.391521744008855,14.853515624999996 62.694309593663206,16.962890625 62.694309593663206,16.083984374999996 63.54855223203643,14.853515624999996 63.391521744008855))')
	x_grid, y_grid = geo2grid(longs, lats, upper_left_lon_x, upper_left_lat_y, pixel_size)
	gridPOLYGON = grid2WKT_polygon(x_grid, y_grid)
	gridPOLYGON

OUTPUT = 'POLYGON ((467 681, 467 764, 720 764, 615 662, 467 681))'





rasdaman.aggregated_result(
	'select avg_cells(clip(c[100, 0:* , 0:*]*0.02, POLYGON ((467 681, 467 764, 720 764, 615 662, 467 681)))) from Surface_Temperature_Sweden AS c'
	) AS avg_clipped;


SELECT
	(SELECT name_2 FROM municipalswe WHERE municipalswe.name_2 = 'Linköping') AS Kommun,
		(SELECT ST_AsText((ST_Dump(geom)).geom) FROM municipalswe WHERE municipalswe.name_2 = 'Linköping') AS VectorPolygon,
		 rasdaman.aggregated_result_numeric('select avg_cells(c[100:200, 0:* , 0:*]*0.02) from Surface_Temperature_Sweden AS c') AS avg_temp;
		 




 
f() = avg_cells()
x = c[TIME, 0:*, 0:*]
TIME = 100:200
pp_factor = 0.02
VECTOR_DATA = POLYGON ((467 681, 467 764, 720 764, 615 662, 467 681))
RASTER_DATA = Surface_Temperature_Sweden


'select [f(x)]
 where x = c[TIME, 0:*, 0:*]*pp_factor, [VECTOR_DATA] 
 from [RASTER_DATA] AS c'






































 "select avg_cells(clip(m[100, 0:* , 0:*]*0.02, POLYGON((595 1269, 594 1269, 593 1269, 593 1270, 594 1271, 595 1271, 595 1271, 596 1271, 596 1272, 597 1272, 598 1272, 598 1272, 599 1272, 600 1272, 600 1273, 600 1273, 600 1274, 601 1274, 601 1274, 601 1275, 601 1275, 600 1275, 600 1276, 599 1276, 599 1276, 599 1277, 600 1277, 601 1277, 602 1277, 603 1277, 604 1277, 605 1277, 605 1278, 606 1278, 606 1278, 606 1279, 606 1279, 607 1279, 608 1279, 609 1279, 609 1280, 609 1280, 609 1281, 610 1281, 610 1281, 610 1282, 611 1282, 611 1282, 611 1283, 613 1283, 613 1283, 612 1284, 611 1284, 609 1284, 610 1284, 609 1284, 608 1284, 608 1285, 607 1285, 606 1285, 605 1284, 604 1284, 604 1285, 605 1285, 604 1285, 602 1285, 603 1286, 602 1286, 601 1286, 599 1286, 600 1287, 600 1287, 601 1287, 601 1288, 600 1288, 599 1288, 598 1288, 598 1288, 597 1288, 597 1288, 596 1288, 596 1287, 594 1287, 593 1287, 593 1287, 592 1287, 592 1287, 592 1288, 591 1288, 592 1288, 591 1288, 589 1289, 588 1289, 587 1289, 587 1289, 586 1289, 585 1289, 586 1290, 584 1290, 585 1290, 584 1290, 584 1291, 583 1291, 583 1290, 581 1290, 582 1291, 582 1291, 582 1292, 582 1293, 583 1293, 583 1293, 582 1293, 582 1294, 581 1294, 581 1294, 582 1294, 582 1295, 583 1295, 583 1295, 584 1295, 584 1296, 584 1296, 585 1296, 585 1297, 584 1297, 584 1297, 584 1298, 583 1298, 583 1298, 584 1299, 584 1300, 585 1299, 585 1300, 585 1301, 586 1301, 586 1301, 585 1301, 585 1302, 585 1302, 585 1303, 584 1303, 584 1303, 583 1303, 582 1303, 581 1303, 580 1303, 580 1304, 579 1304, 578 1304, 577 1304, 577 1305, 576 1305, 576 1305, 575 1305, 575 1306, 574 1306, 573 1306, 573 1305, 572 1305, 571 1305, 571 1305, 570 1305, 570 1305, 569 1305, 569 1306, 570 1306, 570 1306, 570 1307, 570 1308, 570 1308, 569 1308, 568 1308, 567 1308, 567 1309, 566 1309, 565 1309, 564 1309, 563 1309, 563 1308, 563 1308, 563 1307, 563 1307, 562 1307, 562 1306, 561 1306, 560 1306, 560 1306, 559 1306, 558 1306, 557 1306, 556 1306, 556 1305, 555 1305, 554 1305, 553 1305, 553 1304, 552 1304, 551 1304, 551 1305, 552 1305, 552 1306, 552 1307, 552 1307, 552 1308, 552 1308, 551 1308, 551 1309, 551 1309, 551 1310, 551 1310, 551 1311, 551 1311, 550 1311, 550 1312, 549 1312, 549 1313, 548 1313, 548 1313, 547 1313, 547 1314, 546 1314, 546 1314, 547 1315, 546 1315, 546 1315, 547 1315, 547 1316, 547 1316, 547 1317, 547 1318, 546 1318, 546 1318, 545 1318, 544 1318, 544 1319, 543 1319, 543 1319, 542 1319, 541 1319, 541 1320, 540 1320, 540 1319, 539 1319, 539 1319, 539 1318, 540 1318, 540 1318, 539 1318, 538 1318, 537 1318, 537 1318, 537 1319, 537 1320, 536 1320, 536 1320, 535 1320, 535 1321, 534 1321, 533 1321, 532 1321, 531 1321, 530 1321, 530 1320, 530 1320, 530 1319, 531 1319, 531 1319, 530 1319, 529 1319, 528 1319, 528 1318, 527 1318, 526 1318, 526 1317, 526 1317, 526 1316, 525 1316, 524 1316, 523 1316, 522 1316, 522 1316, 521 1316, 520 1316, 520 1315, 520 1315, 520 1314, 519 1314, 519 1314, 519 1313, 519 1313, 519 1312)))) from Surface_Temperature_Sweden as m" 

